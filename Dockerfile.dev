# ==============================================================================
# DEVELOPMENT Dockerfile
# Installs dependencies inside container to avoid platform mismatch
# ==============================================================================
FROM node:22-alpine

# Install tini for proper signal handling
RUN apk add --no-cache tini

WORKDIR /app

# Copy package files
COPY package.json yarn.lock ./

# Install dependencies inside container (avoids macOS/Linux mismatch)
RUN yarn install --frozen-lockfile

# Copy source code
COPY . .

# Generate types
RUN yarn generate

# Use tini as init
ENTRYPOINT ["/sbin/tini", "--"]

EXPOSE 4000

CMD ["yarn", "dev:docker"]
